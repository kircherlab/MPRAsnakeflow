---
title: "QC Measures"
page-layout: full
format:
  html:
    code-fold: true
    code-tools: true
    embed-resources: true
    anchor-sections: true
    smooth-scroll: true
    toc: true
jupyter: python3
---


```{python}
#| tags: [parameters]
#| echo: false
```

```{python}
#| echo: false
# Imports
from IPython.display import display, Image
```



# Assignment QC Report
The Assignment QC (Quality Control) Report is a comprehensive document designed to evaluate and 
ensure the quality of data or processes involved in a specific assignment. This report is generated 
for the `{python} assignment` assignment with settings defined in the config `{python} configs`. The barcode length for this experiment is `{python} bc_length` base pairs.

Forward: `{python} fw`  
Reverse: `{python} rev`  
Barcode: `{python} bc`  
Design File: `{python} design_file`


```{python}
#| echo: false

with open(f"{workdir}/{design_file}") as f:
    seq_num_in_design = 0
    lines = f.readlines()
    for line in lines:
      if line.startswith(">"):
        seq_num_in_design += 1

```


# BC distribution over oligos
```{python}
#| echo: false
display(Image(f"{workdir}/{plot_file}"))
```


# Counts of barcodes and oligos 

```{python}
#| echo: false
import pandas as pd
from IPython.display import HTML, display

df_design = pd.DataFrame({' ': ['Oligos'], 'Design': int(seq_num_in_design)})
df_total = pd.read_csv(f"{workdir}/{statistic_all_file}", sep='\t').rename(columns={'Unnamed: 0': ' ', 'Counts': 'Raw data'})
df_filter = pd.read_csv(f"{workdir}/{statistic_filter_file}", sep='\t').rename(columns={'Unnamed: 0': ' ', 'Counts': 'Filtered data'})



# Concatenate the new row DataFrame with the original DataFrame
df = df_design.merge(df_total, on=' ', how="right")
df = df.merge(df_filter, on=' ', how="right").reset_index(drop=True).fillna(0).astype({"Design": int, "Raw data": int, "Filtered data": int})
df

```